<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>BolÃ£o do BebÃª ðŸ‘¶</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f6f6f6;
  padding: 20px;
  display: flex;
  justify-content: center;
}
.card {
  background: #fff;
  max-width: 450px;
  width: 100%;
  padding: 20px;
  border-radius: 14px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
h2, h4 { text-align: center; }

input, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 16px;
}

button {
  border: none;
  cursor: pointer;
}

.menino { background: #cce5ff; }
.menina { background: #ffd6e7; }
.whatsapp { background: #25D366; color: white; }

.numeros {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 6px;
  margin-top: 10px;
}
.numero {
  background: #eee;
  padding: 8px;
  text-align: center;
  border-radius: 6px;
  cursor: pointer;
}
.numero.usado {
  background: #ccc;
  text-decoration: line-through;
  cursor: not-allowed;
}
.numero.selecionado {
  background: #8bc34a;
  color: white;
}

.pix {
  background: #f1f1f1;
  padding: 10px;
  border-radius: 8px;
  text-align: center;
}
.hidden { display: none; }
</style>
</head>

<body>
<div class="card">

<h2>BolÃ£o do BebÃª ðŸ‘¶</h2>
<p style="text-align:center"><strong>Valor: R$ 5,00</strong></p>

<!-- ETAPA 1 -->
<div id="etapa1">
  <input id="nome" placeholder="Seu nome">

  <button class="menino" onclick="selecionarSexo('Menino ðŸ’™')">ðŸ’™ Menino</button>
  <button class="menina" onclick="selecionarSexo('Menina ðŸ’–')">ðŸ’– Menina</button>

  <button onclick="irParaNumeros()">AvanÃ§ar</button>
</div>

<!-- ETAPA 2 -->
<div id="etapa2" class="hidden">
  <h4>Escolha um nÃºmero</h4>
  <div class="numeros" id="numeros"></div>
  <button onclick="irParaPix()">AvanÃ§ar para Pix</button>
</div>

<!-- ETAPA 3 -->
<div id="etapa3" class="hidden">
  <div class="pix">
    <input id="pixKey" value="e7688ae4-2bae-4f90-847d-8f6702c2f5f3" readonly>
    <button onclick="copiarPix()">ðŸ“‹ Copiar chave Pix</button>

    <p>
      <a href="https://cofrinhos.picpay.com/ambSeb9hby5wYXVsby5uaWNvbGFzLzQvY2hkZWJlYmUvREVGQVVMVA" target="_blank">
        ðŸ‘‰ Abrir QR Code Pix
      </a>
    </p>
  </div>

  <button class="whatsapp" onclick="finalizar()">Enviar comprovante no WhatsApp</button>
</div>

</div>
<script>
/* ===============================
   CONFIGURAÃ‡ÃƒO
================================ */
const API = "https://script.google.com/macros/s/AKfycbzR5NijYoBldIkBox0pMM9d1EQEEk7DToiAn5EYt0ARUQHf2_848oVTJYrxhWe0qclGBw/exec";

let sexoSelecionado = "";
let numeroSelecionado = null;

/* ===============================
   SEXO
================================ */
function selecionarSexo(sexo) {
  sexoSelecionado = sexo;
}

/* ===============================
   IR PARA ETAPA NÃšMEROS
================================ */
function irParaNumeros() {
  const nome = document.getElementById("nome").value.trim();
  if (!nome || !sexoSelecionado) {
    alert("Preencha nome e sexo");
    return;
  }

  document.getElementById("etapa1").style.display = "none";
  document.getElementById("etapa2").style.display = "block";

  carregarNumeros();
}

/* ===============================
   JSONP â†’ CARREGAR NÃšMEROS
================================ */
function carregarNumeros() {
  const script = document.createElement("script");
  script.src = API + "?action=usados&callback=processarNumeros&t=" + Date.now();
  document.body.appendChild(script);
}

function processarNumeros(data) {
  const usados = data.usados || [];
  const container = document.getElementById("numeros");
  container.innerHTML = "";

  for (let i = 1; i <= 200; i++) {
    const div = document.createElement("div");
    div.className = "numero";
    div.innerText = i;

    if (usados.includes(i)) {
      div.classList.add("usado");
    } else {
      div.onclick = () => selecionarNumero(div, i);
    }

    container.appendChild(div);
  }
}

/* ===============================
   SELECIONAR NÃšMERO
================================ */
function selecionarNumero(el, num) {
  document.querySelectorAll(".numero").forEach(n => n.classList.remove("selecionado"));
  el.classList.add("selecionado");
  numeroSelecionado = num;
}

/* ===============================
   IR PARA PIX
================================ */
function irParaPix() {
  if (!numeroSelecionado) {
    alert("Escolha um nÃºmero");
    return;
  }

  document.getElementById("etapa2").style.display = "none";
  document.getElementById("etapa3").style.display = "block";
}

/* ===============================
   COPIAR PIX
================================ */
function copiarPix() {
  const pix = document.getElementById("pixKey");
  pix.select();
  document.execCommand("copy");
  alert("Chave Pix copiada!");
}

/* ===============================
   FINALIZAR â†’ SALVAR NA PLANILHA
   (SEM FETCH, SEM CORS)
================================ */
function finalizar() {
  const nome = document.getElementById("nome").value.trim();

  if (!nome || !sexoSelecionado || !numeroSelecionado) {
    alert("Dados incompletos");
    return;
  }

  // cria formulÃ¡rio invisÃ­vel
  const form = document.createElement("form");
  form.method = "POST";
  form.action = API;
  form.target = "hidden_iframe";

  const campos = {
    nome: nome,
    sexo: sexoSelecionado,
    numero: numeroSelecionado
  };

  for (const key in campos) {
    const input = document.createElement("input");
    input.type = "hidden";
    input.name = key;
    input.value = campos[key];
    form.appendChild(input);
  }

  document.body.appendChild(form);
  form.submit();
  document.body.removeChild(form);

  // abre WhatsApp
  const mensagem = `OlÃ¡! ðŸ‘¶âœ¨
Nome: ${nome}
NÃºmero: ${numeroSelecionado}
Aposta: ${sexoSelecionado}
Valor: R$ 5,00
Segue comprovante ðŸ“Ž`;

  window.open(
    "https://wa.me/5548984065039?text=" + encodeURIComponent(mensagem),
    "_blank"
  );
}
</script>
window.processarNumeros = processarNumeros;

<!-- iframe invisÃ­vel para envio -->
<iframe name="hidden_iframe" style="display:none;"></iframe>

</body>
</html>
